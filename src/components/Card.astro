---
export interface Props {
  image: string;
  title: string;
  href?: string;

  overlayTitle?: string;
  overlayDesc?: string;
  overlayMeta?: string;
}

const {
  image, title, href = "#",
  overlayTitle = title,
  overlayDesc,
  overlayMeta
} = Astro.props as Props;
---

<div
  class="sm-frame"
  style="
    position:relative; width:100%; aspect-ratio:1/1;
    border-radius:18px; overflow:hidden; box-shadow:0 2px 10px rgba(0,0,0,.08);
    isolation:isolate;
  "
>
  <a
    href={href}
    aria-label={title}
    class="sm-link"
    style="position:relative; display:block; width:100%; height:100%; text-decoration:none; cursor:pointer;"
  >
    <!-- IMAGE -->
    <img
      src={image}
      alt={title}
      loading="lazy"
      decoding="async"
      class="sm-media"
      style="position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:block; z-index:1;"
    />

    <!-- Title pill -->
    <span
      class="sm-pill"
      style="
        position:absolute; left:50%; bottom:10px; transform:translateX(-50%);
        background:rgba(0,0,0,.65); color:#fff; padding:6px 14px; border-radius:999px;
        font-weight:600; font-size:14px; z-index:2; transition:opacity .25s ease;
        white-space:nowrap;
      "
    >{title}</span>

    <!-- Semi-transparent orange overlay -->
    <div
      class="sm-overlay"
      style="
        position:absolute; inset:0; z-index:3;
        display:flex; flex-direction:column; align-items:center; justify-content:center;
        background:rgba(225,106,30,0.9);  /* 60% opacity */
        color:#fff;
        transform:translateY(100%); opacity:0;
        transition:transform .35s cubic-bezier(.22,1,.36,1), opacity .3s ease;
        text-align:center; padding:20px;
      "
    >
      <div class="sm-inner" style="transform:translateY(16px); transition:transform .35s cubic-bezier(.22,1,.36,1);">
        {overlayMeta && <div style="font-size:16px; font-weight:600; margin-bottom:6px;">{overlayMeta}</div>}
        <div style="font-size:16px; font-weight:600; margin:6px 0;">{overlayTitle}</div>
        {overlayDesc && <p style="font-size:16px; margin:6px 0;">{overlayDesc}</p>}
      </div>
    </div>
  </a>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.sm-frame').forEach(frame => {
      const overlay = frame.querySelector('.sm-overlay');
      const inner   = frame.querySelector('.sm-inner');
      const pill    = frame.querySelector('.sm-pill');

      const open = () => {
        overlay.style.transform = 'translateY(0%)';
        overlay.style.opacity   = '1';
        inner.style.transform   = 'translateY(0)';
        pill.style.opacity      = '0';
      };
      const close = () => {
        overlay.style.transform = 'translateY(100%)';
        overlay.style.opacity   = '0';
        inner.style.transform   = 'translateY(16px)';
        pill.style.opacity      = '1';
      };

      frame.addEventListener('mouseenter', open);
      frame.addEventListener('mouseleave', close);
      frame.addEventListener('focusin', open);
      frame.addEventListener('focusout', close);
    });
  });
</script>
